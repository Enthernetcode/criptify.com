<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <title>Create Account - Cooperate Finance</title>
    <style>
        /* Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        /* Body and Wrapper */
        body {
            background-color: #f5f5f5;
            color: #333;
        }
        .wrapper {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background-color: #1e1f26;
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header a {
            color: white;
            text-decoration: none;
            margin: 0 15px;
        }
        .header .menu {
            display: flex;
            gap: 20px;
        }
        .header .button {
            background-color: #ff5050;
            padding: 8px 16px;
            border-radius: 5px;
            text-decoration: none;
            color: white;
        }

        /* Main content */
        .create-account-container {
            background-color: #1e1f26;
            padding: 50px 0;
            text-align: center;
            color: white;
            flex: 1;
            background-image: url('your-background-image.jpg'); /* Replace with actual image path */
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
        }

        .button-like {
            padding: 8px 16px;
            border: 1px solid #ccc;
            border-left: none; /* Remove the left border to merge with input */
            background-color: #007bff;
            color: white;
            cursor: pointer;
            cursor: pointer;
            border-radius: 0 4px 4px 0;
            user-select: none; /* Prevent text selection */
        }

        .button-like:hover {
            background-color: #0056b3;
        }
        
        .input-container {
            display: flex;
            align-items: center;
            max-width: 300px;
        }

        .input-field {
            flex: 1;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px 0 0 4px;
            outline: none;
        }


        /* Overlay effect */
        .create-account-container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(30, 31, 38, 0.8); /* Dark overlay */
            z-index: 1;
        }

        /* Account Creation Box */
        .create-account-box {
            position: relative;
            z-index: 2;
            width: 400px;
            margin: auto;
            background-color: #2a2b38;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .create-account-box h2 {
            margin-bottom: 20px;
            font-size: 24px;
        }
        .create-account-box input[type="text"],
        .create-account-box input[type="email"],
        .create-account-box input[type="password"],
        .create-account-box select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: none;
            border-radius: 4px;
            background: #1e1f26;
            color: #fff;
        }
        .create-account-box input[type="checkbox"] {
            margin-top: 15px;
        }
        .create-account-box button {
            width: 100%;
            padding: 10px;
            background-color: #ff5050;
            border: none;
            color: white;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 20px;
        }
        .create-account-box a {
            color: #bbb;
            font-size: 12px;
            text-decoration: none;
        }

        /* Footer */
        .footer {
            background-color: #1e1f26;
            color: #bbb;
            padding: 30px;
            display: flex;
            justify-content: space-around;
            text-align: left;
            flex-wrap: wrap;
        }
        .footer div {
            margin: 10px;
            max-width: 250px;
        }
        .footer a {
            color: #bbb;
            text-decoration: none;
            display: block;
            margin: 5px 0;
        }
        .footer .footer-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .footer-bottom {
            background-color: #ff5050;
            color: white;
            text-align: center;
            padding: 10px;
        }
           /* Responsive Styles */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                text-align: center;
            }
            .header .menu {
                flex-direction: column;
                align-items: center;
            }
            .footer {
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="wrapper">
        <!-- Header -->
        <div class="header">
            <a href="#" class="logo">Cooperate Finance</a>
            <div class="menu">
                <a href="index.html">Home</a>
                <a href="aboutus.html">About Us</a>
                <a href="#">FAQ</a>
                <a href="contact-us.html">Contact Us</a>
                <a href="#">Portfolio</a>
                <a href="signin.html">Login</a>
                <a href="register.html">Register</a>
            </div>
            <a href="#" class="button">Open an account</a>
        </div>

        <!-- Create Account Section -->
        <div class="create-account-container">
            <div class="create-account-box">
                <h2>Create Account</h2>
   <input type="email" id="emailInp" name="emailInp" placeholder="E-mail Address" required>
   <input type="text" id="nameInp" name="nameInp" placeholder="Full Name" required>
   <input type="text" id="userInp" name="username" placeholder="Username" required>
   <input type="password" id="passInp" name="passInp" placeholder="Password" required>
   <input type="text" id="phone" name="phone" placeholder="Phone Number" required>
   <div class="input-container">
        <input type="text" class="input-field" id="otp_code" placeholder="Enter OTP..." maxlength="6" >
        <div class="button-like" onclick="sendOTP()">Get Otp</div>
    </div>
   <select id="country" name="country" required>
      <option value="">Country</option>
      <option value="Afghanistan">Afghanistan</option>
<option value="Albania">Albania</option>
<option value="Algeria">Algeria</option>
<option value="Andorra">Andorra</option>
<option value="Angola">Angola</option>
<option value="Antigua and Barbuda">Antigua and Barbuda</option>
<option value="Argentina">Argentina</option>
<option value="Armenia">Armenia</option>
<option value="Australia">Australia</option>
<option value="Austria">Austria</option>
<option value="Azerbaijan">Azerbaijan</option>
<option value="Bahamas">Bahamas</option>
<option value="Bahrain">Bahrain</option>
<option value="Bangladesh">Bangladesh</option>
<option value="Barbados">Barbados</option>
<option value="Belarus">Belarus</option>
<option value="Belgium">Belgium</option>
<option value="Belize">Belize</option>
<option value="Benin">Benin</option>
<option value="Bhutan">Bhutan</option>
<option value="Bolivia">Bolivia</option>
<option value="Bosnia and Herzegovina">Bosnia and Herzegovina</option>
<option value="Botswana">Botswana</option>
<option value="Brazil">Brazil</option>
<option value="Brunei">Brunei</option>
<option value="Bulgaria">Bulgaria</option>
<option value="Burkina Faso">Burkina Faso</option>
<option value="Burundi">Burundi</option>
<option value="Cabo Verde">Cabo Verde</option>
<option value="Cambodia">Cambodia</option>
<option value="Cameroon">Cameroon</option>
<option value="Canada">Canada</option>
<option value="Central African Republic">Central African Republic</option>
<option value="Chad">Chad</option>
<option value="Chile">Chile</option>
<option value="China">China</option>
<option value="Colombia">Colombia</option>
<option value="Comoros">Comoros</option>
<option value="Congo (Congo-Brazzaville)">Congo (Congo-Brazzaville)</option>
<option value="Costa Rica">Costa Rica</option>
<option value="Croatia">Croatia</option>
<option value="Cuba">Cuba</option>
<option value="Cyprus">Cyprus</option>
<option value="Czechia (Czech Republic)">Czechia (Czech Republic)</option>
<option value="Denmark">Denmark</option>
<option value="Djibouti">Djibouti</option>
<option value="Dominica">Dominica</option>
<option value="Dominican Republic">Dominican Republic</option>
<option value="Ecuador">Ecuador</option>
<option value="Egypt">Egypt</option>
<option value="El Salvador">El Salvador</option>
<option value="Equatorial Guinea">Equatorial Guinea</option>
<option value="Eritrea">Eritrea</option>
<option value="Estonia">Estonia</option>
<option value="Eswatini (Swaziland)">Eswatini (Swaziland)</option>
<option value="Ethiopia">Ethiopia</option>
<option value="Fiji">Fiji</option>
<option value="Finland">Finland</option>
<option value="France">France</option>
<option value="Gabon">Gabon</option>
<option value="Gambia">Gambia</option>
<option value="Georgia">Georgia</option>
<option value="Germany">Germany</option>
<option value="Ghana">Ghana</option>
<option value="Greece">Greece</option>
<option value="Grenada">Grenada</option>
<option value="Guatemala">Guatemala</option>
<option value="Guinea">Guinea</option>
<option value="Guinea-Bissau">Guinea-Bissau</option>
<option value="Guyana">Guyana</option>
<option value="Haiti">Haiti</option>
<option value="Honduras">Honduras</option>
<option value="Hungary">Hungary</option>
<option value="Iceland">Iceland</option>
<option value="India">India</option>
<option value="Indonesia">Indonesia</option>
<option value="Iran">Iran</option>
<option value="Iraq">Iraq</option>
<option value="Ireland">Ireland</option>
<option value="Israel">Israel</option>
<option value="Italy">Italy</option>
<option value="Jamaica">Jamaica</option>
<option value="Japan">Japan</option>
<option value="Jordan">Jordan</option>
<option value="Kazakhstan">Kazakhstan</option>
<option value="Kenya">Kenya</option>
<option value="Kiribati">Kiribati</option>
<option value="Kuwait">Kuwait</option>
<option value="Kyrgyzstan">Kyrgyzstan</option>
<option value="Laos">Laos</option>
<option value="Latvia">Latvia</option>
<option value="Lebanon">Lebanon</option>
<option value="Lesotho">Lesotho</option>
<option value="Liberia">Liberia</option>
<option value="Libya">Libya</option>
<option value="Liechtenstein">Liechtenstein</option>
<option value="Lithuania">Lithuania</option>
<option value="Luxembourg">Luxembourg</option>
<option value="Madagascar">Madagascar</option>
<option value="Malawi">Malawi</option>
<option value="Malaysia">Malaysia</option>
<option value="Maldives">Maldives</option>
<option value="Mali">Mali</option>
<option value="Malta">Malta</option>
<option value="Marshall Islands">Marshall Islands</option>
<option value="Mauritania">Mauritania</option>
<option value="Mauritius">Mauritius</option>
<option value="Mexico">Mexico</option>
<option value="Micronesia">Micronesia</option>
<option value="Moldova">Moldova</option>
<option value="Monaco">Monaco</option>
<option value="Mongolia">Mongolia</option>
<option value="Montenegro">Montenegro</option>
<option value="Morocco">Morocco</option>
<option value="Mozambique">Mozambique</option>
<option value="Myanmar (Burma)">Myanmar (Burma)</option>
<option value="Namibia">Namibia</option>
<option value="Nauru">Nauru</option>
<option value="Nepal">Nepal</option>
<option value="Netherlands">Netherlands</option>
<option value="New Zealand">New Zealand</option>
<option value="Nicaragua">Nicaragua</option>
<option value="Niger">Niger</option>
<option value="Nigeria">Nigeria</option>
<option value="North Korea">North Korea</option>
<option value="North Macedonia">North Macedonia</option>
<option value="Norway">Norway</option>
<option value="Oman">Oman</option>
<option value="Pakistan">Pakistan</option>
<option value="Palau">Palau</option>
<option value="Palestine State">Palestine State</option>
<option value="Panama">Panama</option>
<option value="Papua New Guinea">Papua New Guinea</option>
<option value="Paraguay">Paraguay</option>
<option value="Peru">Peru</option>
<option value="Philippines">Philippines</option>
<option value="Poland">Poland</option>
<option value="Portugal">Portugal</option>
<option value="Qatar">Qatar</option>
<option value="Romania">Romania</option>
<option value="Russia">Russia</option>
<option value="Rwanda">Rwanda</option>
<option value="Saint Kitts and Nevis">Saint Kitts and Nevis</option>
<option value="Saint Lucia">Saint Lucia</option>
<option value="Saint Vincent and the Grenadines">Saint Vincent and the Grenadines</option>
<option value="Samoa">Samoa</option>
<option value="San Marino">San Marino</option>
<option value="Sao Tome and Principe">Sao Tome and Principe</option>
<option value="Saudi Arabia">Saudi Arabia</option>
<option value="Senegal">Senegal</option>
<option value="Serbia">Serbia</option>
<option value="Seychelles">Seychelles</option>
<option value="Sierra Leone">Sierra Leone</option>
<option value="Singapore">Singapore</option>
<option value="Slovakia">Slovakia</option>
<option value="Slovenia">Slovenia</option>
<option value="Solomon Islands">Solomon Islands</option>
<option value="Somalia">Somalia</option>
<option value="South Africa">South Africa</option>
<option value="South Korea">South Korea</option>
<option value="South Sudan">South Sudan</option>
<option value="Spain">Spain</option>
<option value="Sri Lanka">Sri Lanka</option>
<option value="Sudan">Sudan</option>
<option value="Suriname">Suriname</option>
<option value="Sweden">Sweden</option>
<option value="Switzerland">Switzerland</option>
<option value="Syria">Syria</option>
<option value="Tajikistan">Tajikistan</option>
<option value="Tanzania">Tanzania</option>
<option value="Thailand">Thailand</option>
<option value="Timor-Leste">Timor-Leste</option>
<option value="Togo">Togo</option>
<option value="Tonga">Tonga</option>
   </select>
   <input type="text" id="state" name="state" placeholder="State" required>
   <select id="investment" name="investment" required>
      <option value="">Choose ROI</option>
      <option value="low">Low</option>
      <option value="medium">Medium</option>
      <option value="high">High</option>
   </select>
   <input type="text" id="referrer" name="referrer" placeholder="Referrer Username (optional)">
   <input type="text" id="code" name="code" placeholder="Sign-up Code" required>
   <button type="button" id="sub-btn">Register</button>
   <p><a href="signin.html">Have an account already? Login</a></p>
</form>

            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div>
                <p>We provide exceptional investment advice and services, tailored to each client's objectives and risk tolerance. We constantly strive to implement innovative trading technology and data-driven insights to optimize portfolio performance.</p>
            </div>
            <div>
                <p class="footer-title">More Information</p>
                <a href="#">Home</a>
                <a href="#">Privacy Policy</a>
                <a href="#">About Us</a>
                <a href="#">Terms & Conditions</a>
                <a href="#">Contact Us</a>
                <a href="#">Login</a>
                <a href="#">Register</a>
            </div>
            <div>
                <p class="footer-title">Contact Info</p>
                <p>support@Cooperatefinance.com</p>
                <p>3 Minerva Court, Leeds, England, LS1 3JB</p>
                <p>North Central, Toronto, ON, Canada</p>
            </div>
            <div>
                <p>Cooperate Finance is regulated by the UK House Company and EU Securities and Exchange Commission...</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; Copyright Cooperate Finance. All Rights Reserved.</p>
        </div>
    </div>
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
    import { getDatabase, ref, set, update, child, get } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js";

    (function() {
        emailjs.init("BVUOlzj2CdQNf6Gsp");
    })();

    const firebaseConfig = {
        apiKey: "AIzaSyAzK2xnwpUZVPSXTQPscOphtf-9PSyps04",
        authDomain: "cooperate-finance.firebaseapp.com",
        databaseURL: "https://cooperate-finance-default-rtdb.firebaseio.com",
        projectId: "cooperate-finance",
        storageBucket: "cooperate-finance.appspot.com",
        messagingSenderId: "785120987896",
        appId: "1:785120987896:web:9c97861dfd6f908112c90d"
    };
    const app = initializeApp(firebaseConfig);
    const db = getDatabase();

    // REFERENCES
    const username = document.getElementById('userInp');
    const email = document.getElementById('emailInp');
    const password = document.getElementById('passInp');
    const fullname = document.getElementById('nameInp');
    const submitBtn = document.getElementById('sub-btn');
    const phone = document.getElementById('phone');
    const country = document.getElementById('country');
    const state = document.getElementById('state');
    const invest = document.getElementById('investment');
    const refer = document.getElementById('referrer');
    const otpcode = document.getElementById('otp_code');
    const code = document.getElementById('code');
    const x = "901b567";
    let otp;

    const BONUS_AMOUNT = 50; // Bonus amount for referrals

    // VALIDATION
    function isEmptyOrSpaces(str) {
        return str === null || str.match(/^ *$/) !== null;
    }

    function Validation() {
        let nameRegex = /^[a-zA-Z\s]+$/;
        let emailRegex = /^[a-zA-Z0-9]+@(gmail|yahoo|outlook)\.com$/;
        let usernameRegex = /^[a-zA-Z0-9]{5,}$/;

        if (isEmptyOrSpaces(fullname.value) || isEmptyOrSpaces(username.value) || isEmptyOrSpaces(password.value) || isEmptyOrSpaces(email.value) || isEmptyOrSpaces(code.value)) {
            alert("You cannot leave any field empty");
            return false;
        }

        if (!nameRegex.test(fullname.value)) {
            alert('The name should only contain alphabets');
            return false;
        }
        if (!emailRegex.test(email.value)) {
            alert('Please enter a valid email');
            return false;
        }
        if (!usernameRegex.test(username.value)) {
            alert('Username must contain at least 5 alphanumeric characters without spaces');
            return false;
        }
        if (code.value !== x) {
            alert('Wrong sign up code, please contact the admin');
            return false;
        }
        if (otpcode.value !== otp) {
            alert('Wrong OTP code, please retry or contact the admin');
            return false;
        }
        return true;
    }

    function generateOTP(length = 6) {
        otp = '';
        const characters = '0123456789';
        const charactersLength = characters.length;

        for (let i = 0; i < length; i++) {
            otp += characters.charAt(Math.floor(Math.random() * charactersLength));
        }

        return otp;
    }

    window.sendOTP = function() {
        const emailInput = document.getElementById('emailInp').value;
        const otpCode = generateOTP();
        const fname = document.getElementById('userInp').value;

        if (!emailInput) {
            alert('Please enter an email address.');
            return;
        }
        if (!fname) {
            alert('Please enter a fullname.');
            return;
        }

        // Sending the OTP via Email.js
        const serviceID = 'service_1vvxdzj';
        const templateID = 'template_rjdwxve';
        const templateParams = {
            user_email: emailInput,
            otp_code: otpCode,
            name: fname
        };

        emailjs.send(serviceID, templateID, templateParams)
            .then(response => {
                alert('OTP sent successfully!');
                console.log('Success:', response.status, response.text);
            }, error => {
                alert('Failed to send OTP. Please try again.');
                console.log('Error:', error);
            });
    }

    // CREDIT REFERRAL BONUS
    async function creditReferralBonus(referrerUsername) {
        const dbRef = ref(db);
        try {
            const referrerSnapshot = await get(child(dbRef, "UsersList/" + referrerUsername));
            if (!referrerSnapshot.exists()) {
                console.warn("Invalid referral code: Referrer not found.");
                return false;
            }

            const referrerData = referrerSnapshot.val();
            const newBonus = (referrerData.bonus || 0) + BONUS_AMOUNT;
            const newBalance = (referrerData.balance || 0) + BONUS_AMOUNT;

            await update(child(dbRef, "UsersList/" + referrerUsername), {
                bonus: newBonus,
                balance: newBalance
            });

            console.log(`Bonus of ${BONUS_AMOUNT} credited to ${referrerUsername}`);
            return true;
        } catch (error) {
            console.error("Error crediting referral bonus:", error);
            return false;
        }
    }

    // REGISTER USER TO FIREBASE
    async function RegisterUser(event) {
        if (!Validation()) {
            return;
        }

        const dbRef = ref(db);
        const referralCode = refer.value;

        try {
            const snapshot = await get(child(dbRef, "UsersList/" + username.value));
            if (snapshot.exists()) {
                alert("Account already exists!");
                return;
            }

            // Register the new user
            await set(ref(db, "UsersList/" + username.value), {
                fullname: fullname.value,
                username: username.value,
                email: email.value,
                password: encPass(),
                phoneNumber: phone.value,
                country: country.value,
                state: state.value,
                invest: invest.value,
                refferer: referralCode || null,
                isAdmin: false,
                balance: 0,
                date: new Date().toISOString().slice(0, 10),
                last_date: new Date().toISOString().slice(0, 10),
                deposit: 0,
                withdrawal: 0,
                bonus: 0,
                depositHistory: [],
                code: code.value
            });

            alert("User registered successfully");

            // Credit referral bonus if valid referral is provided
            if (referralCode) {
                const success = await creditReferralBonus(referralCode);
                if (success) {
                    alert(`Referral bonus credited to ${referralCode}!`);
                } else {
                    alert(`Invalid referral code: Could not credit bonus.`);
                }
            }

            window.location = "userdashboard/index.html";
        } catch (error) {
            console.error("Error registering user:", error);
            alert("An error occurred during registration. Please try again later.");
        }
    }

    // ENCRYPT PASSWORD
    function encPass() {
        const pass123 = CryptoJS.AES.encrypt(password.value, password.value);
        return pass123.toString();
    }

    // ASSIGN EVENTS
    submitBtn.addEventListener("click", function(event) {
        event.preventDefault();
        RegisterUser(event);
    });
</script>

  </body>
</html>
