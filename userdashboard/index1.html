<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cooperate Finance Dashboard</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet">

    <!-- Stylesheets -->
    <link href="style/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="style/custom.css" rel="stylesheet" type="text/css">
    <link href="style/default.css" rel="stylesheet" type="text/css">
    <link href="style/tab.css" rel="stylesheet" type="text/css">

    <!-- Favicon -->
    <link rel="icon" href="styles/images/favicon.png">

    <!-- JavaScript -->
    <script src="style/jquery.js"></script>
    <script src="style/setting2.js"></script>
    <script src="style/tab.js"></script>
    <script src="style/bootstrap.min.js"></script>
    <script src="restrict.js"></script>

    <style>
        /* Loading Spinner */
        .loading-spinner {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
        }
        .inside_inner_account {
            display: none;
        }
    </style>
</head>
<body class="loginarea">
    <!-- Wrapper -->
    <div class="wrapper-account">
        <div class="headerContainer">
            <div class="headerInner">
                <div class="hdRight">
                    <div class="mainNavRight">
                        <div class="navbar">
                            <div class="navbar-inner"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div class="loading-spinner">
        <img src="styles/images/spinner.gif" alt="Loading...">
    </div>

    <!-- Inner Account Section -->
    <div class="inside_inner_account">
        <div class="member_wrap">
            <div class="membersidebar">
                <ul>
                    <li><a href="customer.html">My Account</a></li>
                    <li><a href="deposit.html">Deposit</a></li>
                    <li><a href="deposit_history.html">Deposits History</a></li>
                    <li><a href="withdraw.html">Withdraw</a></li>
                    <li><a href="referals.html">Referrals</a></li>
                    <li><a id="signoutlink" href="#">Logout</a></li>
                </ul>
            </div>
            <div class="member-container">
                <div class="account_top">
                    <div class="user_left">
                        <h2>Welcome, <span id="userlink" href="#">User</span></h2>
                    </div>
                    <div class="affiliate_top">
                        Affiliate Link: 
                        <a href="http://cooperatefinance/userdashboard/signup.html?ref=test" class="ref-link"></a>
                    </div>
                    <div class="get_banners">
                        <a href="referals.html">Get Banners</a>
                    </div>
                </div>
                <div class="member_right">
                    <center>
                        <!-- TradingView Widget -->
                        <div class="tradingview-widget-container">
                            <div id="tradingview_f933e"></div>
                            <script src="https://s3.tradingview.com/tv.js"></script>
                            <script>
                                new TradingView.widget({
                                    width: 1050,
                                    height: 500,
                                    symbol: "BITFINEX:BTCUSD",
                                    interval: "1",
                                    timezone: "Etc/UTC",
                                    theme: "Dark",
                                    style: "9",
                                    locale: "en",
                                    toolbar_bg: "#f1f3f6",
                                    enable_publishing: false,
                                    hide_side_toolbar: false,
                                    allow_symbol_change: true,
                                    calendar: true,
                                    studies: ["BB@tv-basicstudies"],
                                    container_id: "tradingview_f933e"
                                });
                            </script>
                        </div>
                        <!-- Account Overview -->
                        <h3 class="account_main">Account Overview</h3>
                        <div class="account_overview_wrap">
                            <div class="ctn-invesment-part ctn-invesment-part1">
                                <p>Your Username:</p>
                                <h4 id="usernam">User</h4>
                            </div>
                            <div class="ctn-invesment-part ctn-invesment-part2">
                                <p>Registration Date:</p>
                                <h4 id="userdate">2022-09-02</h4>
                            </div>
                        </div>
                        <div class="account_overview_wrap">
                            <div class="ctn-invesment-part ctn-invesment-part1">
                                <span class="imageblock"></span>
                                <h4>$</h4><h4 id="userdep">$0.00</h4>
                                <p>ACTIVE DEPOSITS</p>
                                <div class="links"><a href="deposit.html">Make A Deposit</a></div>
                            </div>
                            <div class="ctn-invesment-part ctn-invesment-part2">
                                <span class="imageblock"></span>
                                <h4>$</h4><h4 id="userbal">$0.00</h4>
                                <p>YOUR BALANCE</p>
                                <div class="links"><a href="withdraw.html">Withdraw Funds</a></div>
                            </div>
                            <div class="ctn-invesment-part ctn-invesment-part3">
                                <span class="imageblock"></span>
                                <h4>$</h4><h4 id="userbon">$0.00</h4>
                                <p>ADDED BONUS</p>
                                <div class="links"><a href="deposit.html">My Deposits</a></div>
                            </div>
                        </div>
                        <br>
                        <h3 class="account_main">Your Deposits/Withdrawals</h3>
                        <div class="account_stat">
                            <div class="contentLeft">
                                <div class="ctn-inves-row invers-part5">
                                    <p>$0.00</p>
                                    <h1>Last Deposit</h1>
                                </div>
                                <div class="ctn-inves-row invers-part8">
                                    <p>$</p><p id="userwal">$0.00</p>
                                    <h1>Withdrawal</h1>
                                </div>
                            </div>
                        </div>
                    </center>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footerContainer">
        <div class="footerInner">
            <div class="ctn-footer-top">
                <div class="ctn-ft-left">
                    <p>&copy; 2018 cooperatefinance.com All Rights Reserved.</p>
                </div>
                <div class="ft-solid">
                    <a href="https://www.facebook.com/VisualHyipcom/" target="_blank" class="per"></a>
                    <a href="https://twitter.com/VisualHyip" target="_blank" class="twit"></a>
                    <a href="https://plus.google.com/+" target="_blank" class="gplus"></a>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase Initialization -->
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAzK2xnwpUZVPSXTQPscOphtf-9PSyps04",
            authDomain: "cooperate-finance.firebaseapp.com",
            databaseURL: "https://cooperate-finance-default-rtdb.firebaseio.com",
            projectId: "cooperate-finance",
            storageBucket: "cooperate-finance.appspot.com",
            messagingSenderId: "785120987896",
            appId: "1:785120987896:web:9c97861dfd6f908112c90d"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        window.onload = async function () {
            const spinner = document.querySelector('.loading-spinner');
            const accountContent = document.querySelector('.inside_inner_account');

            spinner.style.display = 'block';

            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    try {
                        const doc = await db.collection("users").doc(user.uid).get();
                        if (doc.exists) {
                            const data = doc.data();
                            document.getElementById("userlink").innerText = data.username;
                            document.getElementById("usernam").innerText = data.username;
                            document.getElementById("userdate").innerText = data.registrationDate;
                            document.getElementById("userdep").innerText = `$${data.activeDeposits}`;
                            document.getElementById("userbal").innerText = `$${data.balance}`;
                            document.getElementById("userbon").innerText = `$${data.bonus}`;
                            document.getElementById("userwal").innerText = `$${data.withdrawal}`;

                            spinner.style.display = 'none';
                            accountContent.style.display = 'block';
                        } else {
                            console.error("No user data found!");
                        }
                    } catch (error) {
                        console.error("Error fetching user data:", error);
                    }
                } else {
                    window.location.href = 'login.html';
                }
            });
